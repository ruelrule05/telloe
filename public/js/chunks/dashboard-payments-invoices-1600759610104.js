(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"31/E":function(t,e,n){(e=n("JPst")(!1)).push([t.i,"#invoices .info {\n  transition: all 0.1s ease-in-out;\n  width: 350px;\n  margin-right: -350px;\n}\n#invoices .info.open {\n  margin-right: 0;\n}\n#invoices .pagination .page-item .page-link {\n  background: #F0F2F5;\n}\n#invoices .pagination .page-item.active .page-link {\n  background: #ced4da !important;\n}\n#invoices .select-flex {\n  height: calc(1.5em + 0.7rem);\n}\n#invoices .badge-draft {\n  background-color: rgba(255, 193, 7, 0.125);\n  color: #ffc107;\n}\n#invoices .badge-open {\n  background-color: rgba(90, 90, 223, 0.125);\n  color: #5A5ADF;\n}",""]),t.exports=e},"375c":function(t,e,n){"use strict";var i={name:"more-h"},o=n("KHd+"),a=Object(o.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M 6 10 A 2 2 0 0 0 4 12 A 2 2 0 0 0 6 14 A 2 2 0 0 0 8 12 A 2 2 0 0 0 6 10 z M 12 10 A 2 2 0 0 0 10 12 A 2 2 0 0 0 12 14 A 2 2 0 0 0 14 12 A 2 2 0 0 0 12 10 z M 18 10 A 2 2 0 0 0 16 12 A 2 2 0 0 0 18 14 A 2 2 0 0 0 20 12 A 2 2 0 0 0 18 10 z"}})])}),[],!1,null,null,null);e.a=a.exports},"UQ8+":function(t,e,n){"use strict";var i=n("uNX3");n.n(i).a},"p/fr":function(t,e,n){"use strict";n.r(e);var i=n("o0o1"),o=n.n(i),a=n("L2JU"),s=n("jBWl"),c=n("MCve"),r=n("UEn/"),l=n("T1qZ"),d=n("375c"),v=n("cmxz"),u=n("ITrF"),f=n("q2Ol"),p=n("E73b"),m=n("grtR"),g=n("dRai"),h=n("Wgwc"),_=n.n(h),b=n("vX9Q"),w=n("XuX8"),C=n.n(w),x=n("uv9J"),I=n.n(x);function y(t,e,n,i,o,a,s){try{var c=t[a](s),r=c.value}catch(t){return void n(t)}c.done?e(r):Promise.resolve(r).then(i,o)}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){$(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}C.a.use(I.a);var P={components:{Modal:s.a,VueFormValidate:c.a,VueSelect:r.a,VueButton:l.a,MoreHIcon:d.a,PlusIcon:v.a,ShortcutIcon:u.a,ArrowDownIcon:f.a,TaskIcon:p.a,TrashIcon:m.a,MoreIcon:g.a},directives:{Tooltip:b.a},data:function(){return{newInvoiceForm:{contact_id:"",loading:!1,service_ids:[]},selectedInvoice:null,paginate:["invoices"],invoiceStatuses:[{text:"All",value:"all"},{text:"Draft",value:"draft"},{text:"Open",value:"open"}],invoiceStatus:"all",hasInvoices:!1,openInfo:!1}},computed:k(k({},Object(a.d)({ready:function(t){return t.contacts.ready},contacts:function(t){return t.contacts.index},services:function(t){return t.services.index},pending_invoices:function(t){return t.pending_invoices.index}})),{},{stripeContacts:function(){var t=[];return this.contacts.forEach((function(e){e.is_pending||t.push({text:e.contact_user.full_name,value:e.id})})),t},servicesList:function(){var t=[];return this.services.forEach((function(e){e.is_available&&t.push({text:e.name,value:e.id})})),t},invoices:function(){var t=this,e=[];return this.contacts.forEach((function(n){n.invoices.forEach((function(i){i.contact=n,t.$set(i,"statusLoading",!1),"all"!=t.invoiceStatus&&t.invoiceStatus!=i.status||e.push(i)}))})),e=e.concat(this.pending_invoices),e.sort((function(t,e){return t.created>e.created?-1:1})),e.length>0?this.hasInvoices=!0:(e.push({placeholder:!0}),this.hasInvoices=!1),e}}),watch:{ready:function(t){this.$root.contentloading=!t},invoiceStatus:function(t){this.$refs.paginate&&this.$refs.paginate.goToPage(1)}},created:function(){this.$root.contentloading=!this.ready,this.getUserContacts(),this.getServices(),this.getPendingInvoices()},mounted:function(){var t=this;this.$root.intros.invoices_filter.enabled&&setTimeout((function(){document.querySelector(".introjs-overlay")||t.$root.introJS.start().goToStepNumber(t.$root.intros.invoices_filter.step)}),500)},methods:k(k({},Object(a.b)({getUserContacts:"contacts/index",createContactInvoice:"contacts/create_invoice",finalizeContactInvoice:"contacts/finalize_invoice",getServices:"services/index",getPendingInvoices:"pending_invoices/index",storePendingInvoice:"pending_invoices/store",deletePendingInvoice:"pending_invoices/delete"})),{},{getCurrency:function(t){return t.is_pending?!!this.$root.auth.stripe_account&&(((this.$root.auth.stripe_account.external_accounts||{}).data||[])[0]||{}).currency||"USD":t.currency},finalizeInvoice:function(t){var e,n=this;return(e=o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.statusLoading=!0,e.next=3,n.finalizeContactInvoice(t);case 3:t.statusLoading=!1;case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(t){y(a,i,o,s,c,"next",t)}function c(t){y(a,i,o,s,c,"throw",t)}s(void 0)}))})()},resetInvoiceForm:function(){this.newInvoiceForm={contact_id:"",loading:!1,service_ids:[]},this.openInfo=!1},draftInvoice:function(t){var e=this;if(t.is_pending){this.$set(t,"statusLoading",!0);var n={id:t.contact_id,service_ids:t.service_ids,amount:t.amount/100};this.createContactInvoice(n).then((function(){e.$set(t,"statusLoading",!1),e.deleteInvoice(t)})).catch((function(){e.$set(t,"statusLoading",!1)}))}},deleteInvoice:function(t){t.is_pending&&this.deletePendingInvoice(t)},createInvoice:function(){var t=this;this.newInvoiceForm.loading=!0,this.newInvoiceForm.id=this.newInvoiceForm.contact_id,this.$root.payoutComplete?this.createContactInvoice(this.newInvoiceForm).then((function(){t.resetInvoiceForm()})).catch((function(){t.newInvoiceForm.loading=!1})):this.storePendingInvoice(this.newInvoiceForm).then((function(){t.resetInvoiceForm()})).catch((function(){t.newInvoiceForm.loading=!1}))},formatDate:function(t){return _.a.unix(t).format("MMM d, YYYY h:mmA")}})},O=(n("UQ8+"),n("KHd+")),S=Object(O.a)(P,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"overflow-hidden h-100 flex-grow-1 d-flex flex-column",attrs:{id:"invoices"}},[n("div",{staticClass:"d-flex flex-column h-100 overflow-hidden"},[n("div",{staticClass:"border-bottom bg-white p-3 d-flex align-items-center"},[n("h5",{staticClass:"font-heading mb-0"},[t._v("Invoices")]),t._v(" "),n("div",{staticClass:"ml-auto d-flex align-items-center"},[n("paginate-links",{key:t.invoices.length,attrs:{async:!0,for:"invoices","show-step-links":!0,classes:{ul:["pagination","d-inline-flex","mb-0"],li:["page-item",t.hasInvoices?"page-item":"disabled"],"li > a":["page-link","cursor-pointer"]}}}),t._v(" "),n("div",{staticClass:"d-inline-flex align-items-center mx-2"},[n("vue-select",{attrs:{"data-intro":t.$root.intros.invoices_filter.intro,"data-step":t.$root.intros.invoices_filter.step,options:t.invoiceStatuses,button_class:"border-0 bg-light shadow-none select-flex",label:"Status"},model:{value:t.invoiceStatus,callback:function(e){t.invoiceStatus=e},expression:"invoiceStatus"}})],1),t._v(" "),n("button",{staticClass:"btn btn-light shadow-none d-flex align-items-center",attrs:{"data-intro":t.$root.intros.add_invoice.intro,"data-step":t.$root.intros.add_invoice.step,type:"button"},on:{click:function(e){t.openInfo=!0}}},[n("plus-icon",{staticClass:"btn-icon"}),t._v("\n                        New Invoice\n                    ")],1)],1)]),t._v(" "),n("div",{staticClass:"flex-grow-1 d-flex h-100 overflow-hidden"},[n("div",{staticClass:"d-flex overflow-hidden h-100 w-100"},[n("div",{staticClass:"d-flex flex-column flex-grow-1 px-4 mt-2 pb-4"},[t.invoices.length>0?n("div",{staticClass:"overflow-auto h-100",class:{"d-none":!t.hasInvoices}},[n("table",{staticClass:"table table-borderless table-fixed-header mb-0"},[t._m(0),t._v(" "),n("paginate",{ref:"paginate",attrs:{tag:"tbody",name:"invoices",list:t.invoices,per:15}},[t._l(t.paginated("invoices"),(function(e){return[e.placeholder?t._e():n("tr",{key:e.id},[n("td",{staticClass:"align-middle text-gray-500"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.is_pending?"Not available":e.number||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t"),e.is_pending&&!t.$root.payoutComplete?n("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.right",value:"Please complete your payout account <br /> to create active subscriptions.",expression:"'Please complete your payout account <br /> to create active subscriptions.'",modifiers:{right:!0}}],staticClass:"badge badge-pill shadow-none py-0 px-1 badge-dark border-0 badge-sm cursor-pointer",attrs:{to:"/dashboard/account?tab=payout"}},[n("small",[t._v("?")])]):t._e()],1),t._v(" "),n("td",{staticClass:"align-middle"},[t._v(t._s(((e.amount_due||e.amount)/100).toFixed(2))+" "),n("span",{staticClass:"text-uppercase text-muted"},[t._v(t._s(t.getCurrency(e)))])]),t._v(" "),n("td",{staticClass:"align-middle"},[t._v(t._s(e.contact.contact_user.full_name))]),t._v(" "),n("td",{staticClass:"align-middle"},[n("span",{staticClass:"badge text-capitalize position-relative",class:"badge-"+e.status},[n("span",{class:{"opacity-0":e.statusLoading}},[t._v(t._s(e.status||"Pending"))]),t._v(" "),e.statusLoading?n("div",{staticClass:"position-absolute-center"},[n("div",{staticClass:"spinner-border spinner-border-sm text-primary"})]):t._e()])]),t._v(" "),n("td",{staticClass:"align-middle text-muted"},[t._v(t._s(t.formatDate(e.created)))]),t._v(" "),n("td",{staticClass:"text-right align-middle"},[n("div",{staticClass:"dropleft"},[n("button",{staticClass:"btn btn-white p-1 line-height-0",attrs:{"data-toggle":"dropdown",disabled:e.statusLoading}},[n("more-icon",{staticClass:"fill-gray-500",attrs:{width:"20",height:"20",transform:"scale(0.75)"}})],1),t._v(" "),n("div",{staticClass:"dropdown-menu dropdown-menu-right"},[e.is_pending?[n("span",{staticClass:"dropdown-item d-flex align-items-center cursor-pointer",on:{click:function(n){return t.draftInvoice(e)}}},[n("task-icon",{staticClass:"ml-n2 mr-2 fill-secondary",attrs:{transform:"scale(0.85)"}}),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCreate draft\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")],1),t._v(" "),n("span",{staticClass:"dropdown-item d-flex align-items-center cursor-pointer",on:{click:function(n){t.selectedInvoice=e,t.$refs.deleteModal.show()}}},[n("trash-icon",{staticClass:"ml-n2 mr-2 fill-secondary",attrs:{transform:"scale(0.85)"}}),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")],1)]:["draft"==e.status?[n("span",{staticClass:"dropdown-item d-flex align-items-center cursor-pointer",on:{click:function(n){return t.finalizeInvoice(e)}}},[n("task-icon",{staticClass:"ml-n2 mr-2 fill-secondary",attrs:{transform:"scale(0.85)"}}),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFinalize Invoice\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")],1)]:[n("a",{staticClass:"dropdown-item d-flex align-items-center",attrs:{target:"_blank",href:e.hosted_invoice_url}},[n("shortcut-icon",{staticClass:"ml-n2 mr-2 fill-secondary",attrs:{transform:"scale(0.75)"}}),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPayment page\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")],1),t._v(" "),n("a",{staticClass:"dropdown-item d-flex align-items-center",attrs:{href:e.invoice_pdf,download:""}},[n("arrow-down-icon",{staticClass:"ml-n2 mr-2 fill-secondary"}),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDownload PDF\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")],1)]]],2)])])])]}))],2)],1)]):t._e(),t._v(" "),0!=t.invoices.length&&t.hasInvoices?t._e():n("div",{staticClass:"text-muted text-center position-absolute-center"},[n("div",{staticClass:"h6 text-secondary font-weight-normal mb-0"},[t._v("No invoices found.")])])]),t._v(" "),n("div",{staticClass:"info bg-white h-100 border-left p-3 overflow-auto d-flex flex-column",class:{open:t.openInfo}},[n("h5",{staticClass:"font-heading mb-3"},[t._v("Create Invoice")]),t._v(" "),n("vue-form-validate",{staticClass:"d-flex flex-column flex-grow-1",on:{submit:function(e){return t.createInvoice()}}},[n("div",{staticClass:"flex-grow-1"},[n("div",{staticClass:"form-group"},[n("label",{staticClass:"form-label"},[t._v("Contact")]),t._v(" "),n("vue-select",{attrs:{options:t.stripeContacts,searchable:"",required:"",placeholder:"Find contact"},model:{value:t.newInvoiceForm.contact_id,callback:function(e){t.$set(t.newInvoiceForm,"contact_id",e)},expression:"newInvoiceForm.contact_id"}})],1),t._v(" "),n("div",{staticClass:"form-group"},[n("label",{staticClass:"form-label"},[t._v("Amount")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.newInvoiceForm.amount,expression:"newInvoiceForm.amount"}],staticClass:"form-control",attrs:{type:"number",step:"0.01","data-required":"",placeholder:"Amount"},domProps:{value:t.newInvoiceForm.amount},on:{input:function(e){e.target.composing||t.$set(t.newInvoiceForm,"amount",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"form-group"},[n("label",{staticClass:"form-label"},[t._v("Booking Types (Optional)")]),t._v(" "),n("vue-select",{attrs:{options:t.servicesList,multiple:"",placeholder:"Select booking type"},model:{value:t.newInvoiceForm.service_ids,callback:function(e){t.$set(t.newInvoiceForm,"service_ids",e)},expression:"newInvoiceForm.service_ids"}})],1)]),t._v(" "),n("div",{staticClass:"d-flex align-items-center"},[n("button",{staticClass:"btn btn-white mr-1 border",attrs:{type:"button",disabled:t.newInvoiceForm.loading},on:{click:function(e){t.openInfo=!1}}},[t._v("Cancel")]),t._v(" "),n("vue-button",{attrs:{type:"submit",loading:t.newInvoiceForm.loading,button_class:"ml-auto btn btn-primary"}},[t._v("Create")])],1)])],1)])])]),t._v(" "),n("modal",{ref:"createInvoiceModal",attrs:{"close-button":!1},on:{hidden:function(e){return t.resetInvoiceForm()}}}),t._v(" "),n("modal",{ref:"deleteModal",attrs:{"close-button":!1}},[t.selectedInvoice?[n("h5",{staticClass:"font-heading text-center"},[t._v("Delete Invoice")]),t._v(" "),n("p",{staticClass:"text-center mt-3"},[t._v("\n\t\t\t\t\tAre you sure to delete this invoice? "),n("br"),t._v(" "),n("span",{staticClass:"text-danger"},[t._v("This action cannot be undone")])]),t._v(" "),n("div",{staticClass:"d-flex justify-content-end"},[n("button",{staticClass:"btn btn-white border text-body",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Cancel")]),t._v(" "),n("button",{staticClass:"btn btn-danger ml-auto",attrs:{type:"button"},on:{click:function(e){t.deleteInvoice(t.selectedInvoice),t.$refs.deleteModal.hide()}}},[t._v("Delete")])])]:t._e()],2)],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("Invoice ID")]),t._v(" "),n("th",[t._v("Amount")]),t._v(" "),n("th",[t._v("Contact")]),t._v(" "),n("th",[t._v("Status")]),t._v(" "),n("th",[t._v("Date Created")]),t._v(" "),n("th")])])}],!1,null,null,null);e.default=S.exports},uNX3:function(t,e,n){var i=n("31/E");"string"==typeof i&&(i=[[t.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(i,o);i.locals&&(t.exports=i.locals)}}]);